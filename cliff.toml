# git-cliff é»˜è®¤é…ç½®æ–‡ä»¶
# å®˜æ–¹æ–‡æ¡£ï¼šhttps://git-cliff.org/docs/configuration
#
# ä»¥ä¸‹é…ç½®ä»¥è¡¨ï¼ˆtableï¼‰å’Œé”®ï¼ˆkeyï¼‰çš„å½¢å¼ç»„ç»‡
# æ‰€æœ‰ä»¥ "#" å¼€å¤´çš„è¡Œä¸ºæ³¨é‡Šè¡Œï¼Œä¸ä¼šè¢«æ‰§è¡Œ

[changelog]
# changelog æ–‡ä»¶å¤´éƒ¨æ¨¡æ¿
header = """
# æ›´æ–°æ—¥å¿—\n
æœ¬æ–‡ä»¶è®°å½•äº†è¯¥é¡¹ç›®çš„æ‰€æœ‰é‡è¦å˜æ›´ã€‚\n
"""

# changelog ä¸»ä½“æ¨¡æ¿ï¼ˆä½¿ç”¨ Tera æ¨¡æ¿è¯­æ³•ï¼‰
# Tera æ¨¡æ¿è¯­æ³•æ–‡æ¡£ï¼šhttps://keats.github.io/tera/docs/
body = """
{% if version %}\
    ## [{{ version | trim_start_matches(pat="v") }}] - {{ timestamp | date(format="%Y-%m-%d") }}
{% else %}\
    ## [æœªå‘å¸ƒç‰ˆæœ¬]
{% endif %}\
{% for group, commits in commits | group_by(attribute="group") %}
    ### {{ group | striptags | trim | upper_first }}
    {% for commit in commits %}
        - {% if commit.scope %}*({{ commit.scope }})* {% endif %}\
            {% if commit.breaking %}[**ç ´åæ€§ä¿®æ”¹**] {% endif %}\
            {{ commit.message | upper_first }}\
    {% endfor %}
{% endfor %}\n
"""

# changelog å°¾éƒ¨æ¨¡æ¿
footer = """
---

### ğŸ” ç›¸å…³é“¾æ¥
- é—®é¢˜åé¦ˆï¼š[Issues](<REPO>/issues)
- é¡¹ç›®ä¸»é¡µï¼š[g1331/xiaomai-bot](<REPO>)

> æœ¬æ–‡æ¡£ç”± [git-cliff](https://git-cliff.org) æ ¹æ® Git æäº¤è®°å½•è‡ªåŠ¨ç”Ÿæˆ
"""

# æ˜¯å¦è£å‰ªå¤´å°¾ç©ºç™½å­—ç¬¦
trim = true

# åå¤„ç†å™¨ï¼ˆä¾‹å¦‚æ›¿æ¢é“¾æ¥ï¼‰
postprocessors = [
  { pattern = '<REPO>', replace = "https://github.com/g1331/xiaomai-bot" }, # æ›¿æ¢ä»“åº“åœ°å€
]

# å³ä½¿æ²¡æœ‰ç‰ˆæœ¬ä¹Ÿå¼ºåˆ¶æ¸²æŸ“ changelog ä¸»ä½“
# render_always = true

# è¾“å‡ºæ–‡ä»¶è·¯å¾„ï¼ˆé»˜è®¤å†™å…¥ stdoutï¼‰
# output = "CHANGELOG.md"

[git]
# ä½¿ç”¨ conventional commits è§„èŒƒè§£ææäº¤æ—¥å¿—
conventional_commits = true

# åªä¿ç•™ç¬¦åˆè§„èŒƒçš„æäº¤
filter_unconventional = true

# æ˜¯å¦å°†æ¯ä¸€è¡Œä½œä¸ºç‹¬ç«‹æäº¤è§£æ
split_commits = false

# æäº¤æ¶ˆæ¯é¢„å¤„ç†å™¨ï¼ˆæ”¯æŒæ­£åˆ™æ›¿æ¢ï¼‰
commit_preprocessors = [
  # ç¤ºä¾‹ï¼šå°† issue ç¼–å·æ›¿æ¢ä¸ºé“¾æ¥
  { pattern = '\((\w+\s)?#([0-9]+)\)', replace = "([#${2}](<REPO>/issues/${2}))" },
  # ç¤ºä¾‹ï¼šæ‹¼å†™æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤ï¼ˆéœ€å®‰è£… typos å·¥å…·ï¼‰
  # { pattern = '.*', replace_command = 'typos --write-changes -' },
]

# æäº¤åˆ†ç±»å™¨ï¼Œæ ¹æ®æäº¤å†…å®¹åˆ’åˆ†åˆ†ç»„
commit_parsers = [
  { message = "^feat", group = "<!-- 0 -->ğŸš€ æ–°ç‰¹æ€§" },
  { message = "^fix", group = "<!-- 1 -->ğŸ› ä¿®å¤é—®é¢˜" },
  { message = "^doc", group = "<!-- 3 -->ğŸ“š æ–‡æ¡£ç›¸å…³" },
  { message = "^perf", group = "<!-- 4 -->âš¡ æ€§èƒ½ä¼˜åŒ–" },
  { message = "^refactor", group = "<!-- 2 -->ğŸšœ ä»£ç é‡æ„" },
  { message = "^style", group = "<!-- 5 -->ğŸ¨ ä»£ç æ ¼å¼" },
  { message = "^test", group = "<!-- 6 -->ğŸ§ª æµ‹è¯•ç›¸å…³" },
  { message = "^chore\\(release\\): prepare for", skip = true },  # å¿½ç•¥å‘å¸ƒå‡†å¤‡ç±»æäº¤
  { message = "^chore\\(deps.*\\)", skip = true },               # å¿½ç•¥ä¾èµ–ç±»æäº¤
  { message = "^chore\\(pr\\)", skip = true },
  { message = "^chore\\(pull\\)", skip = true },
  { message = "^chore|^ci", group = "<!-- 7 -->âš™ï¸ å…¶ä»–ä»»åŠ¡" },
  { body = ".*security", group = "<!-- 8 -->ğŸ›¡ï¸ å®‰å…¨ç›¸å…³" },
  { message = "^revert", group = "<!-- 9 -->â—€ï¸ å›æ»šæäº¤" },
  { message = ".*", group = "<!-- 10 -->ğŸ’¼ å…¶ä»–ä¿®æ”¹" },
]

# æ˜¯å¦è¿‡æ»¤æ‰æœªè¢«ä¸Šè¿°è§„åˆ™åŒ¹é…çš„æäº¤ï¼ˆfalse è¡¨ç¤ºä¿ç•™ï¼‰
filter_commits = false

# æ˜¯å¦æŒ‰ Git æ‹“æ‰‘é¡ºåºæ’åºæ ‡ç­¾
topo_order = false

# æ¯ä¸ªåˆ†ç±»ç»„å†…çš„æäº¤æ’åºæ–¹å¼ï¼ˆnewest/oldestï¼‰
sort_commits = "newest"
